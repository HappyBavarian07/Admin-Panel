<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<script>
    window.onload = function () {
        // Check if the user is logged in and the page is loaded by the dashboard iframe
        if (window.parent !== window) {
            // Get the JWT token from the parent window
            const token = top.getCookie('adminpanel_webui_jwtToken');

            // Send an API call to the server to verify the JWT token
            fetch('/adminpanel/token-check', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                },
                body: 'token=' + encodeURIComponent(token)
            })
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        // Handle error
                        // For example, redirect to the login page
                        alert("You are getting redirected to the login page");
                        top.location.href = '/adminpanel/login';
                    } else {
                        // Handle success
                        // For example, show the dashboard
                        // Get the URL parameters
                        const params = new URLSearchParams(window.location.search);

                        // Get the 'world' parameter
                        const world = params.get('world');

                        // If the 'world' parameter is not null, change the h1 text
                        if (world !== null) {
                            document.querySelector('h1').textContent = 'Worlds Page loaded with world: ' + world;
                        }
                    }
                });
        } else {
            // Handle error
            // For example, redirect to the login page
            top.location.href = '/adminpanel/login';
        }
    };
</script>
</body>
</html>